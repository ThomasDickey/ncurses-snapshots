<!--
  * t
  ****************************************************************************
  * Copyright 2018-2019,2020 Thomas E. Dickey                                *
  * Copyright 1998-2015,2017 Free Software Foundation, Inc.                  *
  *                                                                          *
  * Permission is hereby granted, free of charge, to any person obtaining a  *
  * copy of this software and associated documentation files (the            *
  * "Software"), to deal in the Software without restriction, including      *
  * without limitation the rights to use, copy, modify, merge, publish,      *
  * distribute, distribute with modifications, sublicense, and/or sell       *
  * copies of the Software, and to permit persons to whom the Software is    *
  * furnished to do so, subject to the following conditions:                 *
  *                                                                          *
  * The above copyright notice and this permission notice shall be included  *
  * in all copies or substantial portions of the Software.                   *
  *                                                                          *
  * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS  *
  * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF               *
  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.   *
  * IN NO EVENT SHALL THE ABOVE COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,   *
  * DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR    *
  * OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR    *
  * THE USE OR OTHER DEALINGS IN THE SOFTWARE.                               *
  *                                                                          *
  * Except as contained in this notice, the name(s) of the above copyright   *
  * holders shall not be used in advertising or otherwise to promote the     *
  * sale, use or other dealings in this Software without prior written       *
  * authorization.                                                           *
  ****************************************************************************
  * @Id: curs_util.3x,v 1.60 2020/12/19 22:44:46 tom Exp @
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<meta name="generator" content="Manpage converted by man2html - see https://invisible-island.net/scripts/readme.html#others_scripts">
<TITLE>curs_util 3X</TITLE>
<link rel="author" href="mailto:bug-ncurses@gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</HEAD>
<BODY>
<H1 class="no-header">curs_util 3X</H1>
<PRE>
<B><A HREF="curs_util.3X.html">curs_util(3X)</A></B>                                                    <B><A HREF="curs_util.3X.html">curs_util(3X)</A></B>




</PRE><H2><a name="h2-NAME">NAME</a></H2><PRE>
       <B>delay_output</B>, <B>filter</B>, <B>flushinp</B>, <B>getwin</B>, <B>key_name</B>, <B>keyname</B>, <B>nofilter</B>,
       <B>putwin</B>, <B>unctrl</B>, <B>use_env</B>, <B>use_tioctl</B>, <B>wunctrl</B> - miscellaneous <B>curses</B>
       utility routines


</PRE><H2><a name="h2-SYNOPSIS">SYNOPSIS</a></H2><PRE>
       <B>#include</B> <B>&lt;curses.h&gt;</B>

       <B>const</B> <B>char</B> <B>*unctrl(chtype</B> <I>c</I><B>);</B>
       <B>wchar_t</B> <B>*wunctrl(cchar_t</B> <B>*</B><I>c</I><B>);</B>

       <B>const</B> <B>char</B> <B>*keyname(int</B> <I>c</I><B>);</B>
       <B>const</B> <B>char</B> <B>*key_name(wchar_t</B> <I>w</I><B>);</B>

       <B>void</B> <B>filter(void);</B>
       <B>void</B> <B>nofilter(void);</B>

       <B>void</B> <B>use_env(bool</B> <I>f</I><B>);</B>
       <B>void</B> <B>use_tioctl(bool</B> <I>f</I><B>);</B>

       <B>int</B> <B>putwin(WINDOW</B> <B>*</B><I>win</I><B>,</B> <B>FILE</B> <B>*</B><I>filep</I><B>);</B>
       <B>WINDOW</B> <B>*getwin(FILE</B> <B>*</B><I>filep</I><B>);</B>

       <B>int</B> <B>delay_output(int</B> <I>ms</I><B>);</B>
       <B>int</B> <B>flushinp(void);</B>


</PRE><H2><a name="h2-DESCRIPTION">DESCRIPTION</a></H2><PRE>

</PRE><H3><a name="h3-unctrl">unctrl</a></H3><PRE>
       The <B>unctrl</B> routine returns a character string which is a printable rep-
       resentation of the character <I>c</I>, ignoring attributes.   Control  charac-
       ters  are  displayed  in the <B>^</B><I>X</I> notation.  Printing characters are dis-
       played as is.  The corresponding <B>wunctrl</B> returns a printable  represen-
       tation of a wide character.


</PRE><H3><a name="h3-keyname_key_name">keyname/key_name</a></H3><PRE>
       The <B>keyname</B> routine returns a character string corresponding to the key
       <I>c</I>:

       <B>o</B>   Printable characters are displayed as themselves, e.g., a one-char-
           acter string containing the key.

       <B>o</B>   Control characters are displayed in the <B>^</B><I>X</I> notation.

       <B>o</B>   DEL (character 127) is displayed as <B>^?</B>.

       <B>o</B>   Values  above 128 are either meta characters (if the screen has not
           been initialized, or if <B><A HREF="curs_inopts.3X.html">meta(3X)</A></B> has been called with a <B>TRUE</B> param-
           eter),  shown  in the <B>M-</B><I>X</I> notation, or are displayed as themselves.
           In the latter case, the values may not be printable;  this  follows
           the X/Open specification.

       <B>o</B>   Values above 256 may be the names of the names of function keys.

       <B>o</B>   Otherwise  (if there is no corresponding name) the function returns
           null, to denote an error.  X/Open also lists an "UNKNOWN  KEY"  re-
           turn value, which some implementations return rather than null.

       The  corresponding <B>key_name</B> returns a character string corresponding to
       the wide-character value <I>w</I>.  The two functions do not return  the  same
       set  of strings; the latter returns null where the former would display
       a meta character.


</PRE><H3><a name="h3-filter_nofilter">filter/nofilter</a></H3><PRE>
       The <B>filter</B> routine, if used, must be called before <B>initscr</B>  or  <B>newterm</B>
       are called.  Calling <B>filter</B> causes these changes in initialization:

       <B>o</B>   <B>LINES</B> is set to 1;

       <B>o</B>   the  capabilities  <B>clear</B>,  <B>cud1</B>,  <B>cud</B>, <B>cup</B>, <B>cuu1</B>, <B>cuu</B>, <B>vpa</B> are dis-
           abled;

       <B>o</B>   the capability <B>ed</B> is disabled if <B>bce</B> is set;

       <B>o</B>   and the <B>home</B> string is set to the value of <B>cr</B>.

       The <B>nofilter</B> routine cancels the effect of  a  preceding  <B>filter</B>  call.
       That  allows  the  caller to initialize a screen on a different device,
       using a different value of <B>$TERM</B>.  The limitation  arises  because  the
       <B>filter</B> routine modifies the in-memory copy of the terminal information.


</PRE><H3><a name="h3-use_env">use_env</a></H3><PRE>
       The  <B>use_env</B>  routine,  if  used,  should  be  called before <B>initscr</B> or
       <B>newterm</B> are called (because those compute the screen size).   It  modi-
       fies  the way <B>ncurses</B> treats environment variables when determining the
       screen size.

       <B>o</B>   Normally <B>ncurses</B> looks first  at  the  terminal  database  for  the
           screen size.

           If  <B>use_env</B>  was called with <B>FALSE</B> for parameter, it stops here un-
           less <B>use_tioctl</B> was also called with <B>TRUE</B> for parameter.

       <B>o</B>   Then it asks for the screen size via operating  system  calls.   If
           successful, it overrides the values from the terminal database.

       <B>o</B>   Finally  (unless  <B>use_env</B> was called with <B>FALSE</B> parameter), <B>ncurses</B>
           examines the <B>LINES</B> or <B>COLUMNS</B> environment variables, using a  value
           in  those to override the results from the operating system or ter-
           minal database.

           <B>Ncurses</B> also updates the screen size in response to  <B>SIGWINCH</B>,  un-
           less overridden by the <B>LINES</B> or <B>COLUMNS</B> environment variables,


</PRE><H3><a name="h3-use_tioctl">use_tioctl</a></H3><PRE>
       The  <B>use_tioctl</B>  routine,  if  used, should be called before <B>initscr</B> or
       <B>newterm</B> are called (because those  compute  the  screen  size).   After
       <B>use_tioctl</B>  is  called  with  <B>TRUE</B> as an argument, <B>ncurses</B> modifies the
       last step in its computation of screen size as follows:

       <B>o</B>   checks if the <B>LINES</B> and <B>COLUMNS</B> environment variables are set to  a
           number greater than zero.

       <B>o</B>   for  each,  <B>ncurses</B>  updates the corresponding environment variable
           with the value that it has obtained via operating  system  call  or
           from the terminal database.

       <B>o</B>   <B>ncurses</B>  re-fetches  the value of the environment variables so that
           it is still the environment variables which set the screen size.

       The <B>use_env</B> and <B>use_tioctl</B> routines combine as summarized here:

           <I>use</I><B>_</B><I>env</I>   <I>use</I><B>_</B><I>tioctl</I>   <I>Summary</I>
           ----------------------------------------------------------------
           TRUE      FALSE        This is the default  behavior.   <B>ncurses</B>
                                  uses operating system calls unless over-
                                  ridden by $LINES or $COLUMNS environment
                                  variables.

           TRUE      TRUE         <B>ncurses</B>   updates  $LINES  and  $COLUMNS
                                  based on operating system calls.
           FALSE     TRUE         <B>ncurses</B> ignores $LINES and $COLUMNS, us-
                                  es  operating  system  calls  to  obtain
                                  size.
           FALSE     FALSE        <B>ncurses</B> relies on the terminal  database
                                  to determine size.


</PRE><H3><a name="h3-putwin_getwin">putwin/getwin</a></H3><PRE>
       The  <B>putwin</B> routine writes all data associated with window (or pad) <I>win</I>
       into the file to which <I>filep</I> points.  This information can be later re-
       trieved using the <B>getwin</B> function.

       The  <B>getwin</B>  routine  reads  window  related data stored in the file by
       <B>putwin</B>.  The routine then creates and initializes a  new  window  using
       that  data.   It  returns a pointer to the new window.  There are a few
       caveats:

       <B>o</B>   the data written is a copy of the <B>WINDOW</B> structure, and its associ-
           ated  character cells.  The format differs between the wide-charac-
           ter (<B>ncursesw</B>) and non-wide (<B>ncurses</B>) libraries.  You can  transfer
           data between the two, however.

       <B>o</B>   the  retrieved  window  is always created as a top-level window (or
           pad), rather than a subwindow.

       <B>o</B>   the window's character cells contain the color pair <I>value</I>, but  not
           the  actual  color  <I>numbers</I>.   If cells in the retrieved window use
           color pairs which have not been created in  the  application  using
           <B>init_pair</B>, they will not be colored when the window is refreshed.


</PRE><H3><a name="h3-delay_output">delay_output</a></H3><PRE>
       The  <B>delay_output</B>  routine  inserts  an <I>ms</I> millisecond pause in output.
       This routine should not be used extensively because padding  characters
       are  used  rather  than a CPU pause.  If no padding character is speci-
       fied, this uses <B>napms</B> to perform the delay.


</PRE><H3><a name="h3-flushinp">flushinp</a></H3><PRE>
       The <B>flushinp</B> routine throws away any typeahead that has been  typed  by
       the user and has not yet been read by the program.


</PRE><H2><a name="h2-RETURN-VALUE">RETURN VALUE</a></H2><PRE>
       Except  for  <B>flushinp</B>,  routines that return an integer return <B>ERR</B> upon
       failure and <B>OK</B> (SVr4 specifies only "an integer value other than  <B>ERR</B>")
       upon successful completion.

       Routines that return pointers return <B>NULL</B> on error.

       X/Open does not define any error conditions.  In this implementation

          <B>flushinp</B>
               returns an error if the terminal was not initialized.

          <B>putwin</B>
               returns  an  error if the associated <B>fwrite</B> calls return an er-
               ror.


</PRE><H2><a name="h2-PORTABILITY">PORTABILITY</a></H2><PRE>

</PRE><H3><a name="h3-filter">filter</a></H3><PRE>
       The SVr4 documentation describes the  action  of  <B>filter</B>  only  in  the
       vaguest  terms.   The  description  here is adapted from the XSI Curses
       standard (which erroneously fails to describe the disabling of <B>cuu</B>).


</PRE><H3><a name="h3-keyname">keyname</a></H3><PRE>
       The <B>keyname</B> function may return the names of user-defined string  capa-
       bilities  which  are defined in the terminfo entry via the <B>-x</B> option of
       <B>tic</B>.  This implementation automatically assigns at run-time keycodes to
       user-defined  strings  which  begin  with  "k".   The keycodes start at
       KEY_MAX, but are not guaranteed to be the same value for different runs
       because  user-defined  codes  are merged from all terminal descriptions
       which have been loaded.  The <B><A HREF="curs_extend.3X.html">use_extended_names(3X)</A></B>  function  controls
       whether  this  data  is loaded when the terminal description is read by
       the library.


</PRE><H3><a name="h3-nofilter_use_tioctl">nofilter/use_tioctl</a></H3><PRE>
       The <B>nofilter</B> and <B>use_tioctl</B> routines are  specific  to  <B>ncurses</B>.   They
       were  not  supported on Version 7, BSD or System V implementations.  It
       is recommended that any code depending on <B>ncurses</B> extensions be  condi-
       tioned using NCURSES_VERSION.


</PRE><H3><a name="h3-putwin_getwin">putwin/getwin</a></H3><PRE>
       The <B>putwin</B> and <B>getwin</B> functions have several issues with portability:

       <B>o</B>   The  files  written  and read by these functions use an implementa-
           tion-specific format.  Although the format is an obvious target for
           standardization, it has been overlooked.

           Interestingly  enough,  according to the copyright dates in Solaris
           source, the functions (along with <B>scr_init</B>, etc.)  originated  with
           the University of California, Berkeley (in 1982) and were later (in
           1988) incorporated into SVr4.  Oddly, there are no  such  functions
           in the 4.3BSD curses sources.

       <B>o</B>   Most implementations simply dump the binary <B>WINDOW</B> structure to the
           file.  These include SVr4 curses, NetBSD and PDCurses, as  well  as
           older <B>ncurses</B> versions.  This implementation (as well as the X/Open
           variant of Solaris curses, dated 1995) uses textual dumps.

           The implementations which  use  binary  dumps  use  block-I/O  (the
           <B>fwrite</B>  and  <B>fread</B>  functions).   Those  that use textual dumps use
           buffered-I/O.  A few applications may happen to write extra data in
           the  file  using these functions.  Doing that can run into problems
           mixing block- and buffered-I/O.  This  implementation  reduces  the
           problem  on writes by flushing the output.  However, reading from a
           file written using mixed schemes may not be successful.


</PRE><H3><a name="h3-unctrl_wunctrl">unctrl/wunctrl</a></H3><PRE>
       The XSI Curses standard, Issue 4 describes these functions.  It  states
       that <B>unctrl</B> and <B>wunctrl</B> will return a null pointer if unsuccessful, but
       does not define any error conditions.  This implementation  checks  for
       three cases:

       <B>o</B>   the  parameter  is  a  7-bit  US-ASCII code.  This is the case that
           X/Open Curses documented.

       <B>o</B>   the parameter is in the range 128-159, i.e., a C1 control code.  If
           <B><A HREF="legacy_coding.3X.html">use_legacy_coding(3X)</A></B>  has  been  called with a <B>2</B> parameter, <B>unctrl</B>
           returns the parameter, i.e., a one-character string with the param-
           eter  as  the  first  character.  Otherwise, it returns "~@", "~A",
           etc., analogous to "^@", "^A", C0 controls.

           X/Open Curses does not document whether <B>unctrl</B> can be called before
           initializing curses.  This implementation permits that, and returns
           the "~@", etc., values in that case.

       <B>o</B>   parameter values outside the 0 to 255 range.  <B>unctrl</B> returns a null
           pointer.

       The strings returned by <B>unctrl</B> in this implementation are determined at
       compile time, showing C1 controls from the upper-128 codes with  a  "~"
       prefix  rather  than "^".  Other implementations have different conven-
       tions.  For example, they may show both sets of control characters with
       "^", and strip the parameter to 7 bits.  Or they may ignore C1 controls
       and treat all of the upper-128 codes as printable.  This implementation
       uses  8  bits  but  does  not modify the string to reflect locale.  The
       <B><A HREF="legacy_coding.3X.html">use_legacy_coding(3X)</A></B> function allows the caller to change  the  output
       of <B>unctrl</B>.

       Likewise,  the <B><A HREF="curs_inopts.3X.html">meta(3X)</A></B> function allows the caller to change the output
       of <B>keyname</B>, i.e., it determines whether to  use  the  "M-"  prefix  for
       "meta"  keys  (codes  in  the  range 128 to 255).  Both <B>use_legacy_cod-</B>
       <B><A HREF="use_legacy_coding.3X.html">ing(3X)</A></B> and <B><A HREF="curs_inopts.3X.html">meta(3X)</A></B> succeed only after curses is initialized.   X/Open
       Curses  does  not  document  the  treatment  of codes 128 to 159.  When
       treating them as "meta" keys (or if <B>keyname</B> is called before initializ-
       ing curses), this implementation returns strings "M-^@", "M-^A", etc.

       X/Open Curses documents <B>unctrl</B> as declared in <B>&lt;unctrl.h&gt;</B>, which <B>ncurses</B>
       does.  However, <B>ncurses</B>' <B>&lt;curses.h&gt;</B> includes <B>&lt;unctrl.h&gt;</B>,  matching  the
       behavior of SVr4 curses.  Other implementations may not do that.


</PRE><H3><a name="h3-use_env_use_tioctl">use_env/use_tioctl</a></H3><PRE>
       If  <B>ncurses</B>  is  configured  to provide the sp-functions extension, the
       state of <B>use_env</B> and <B>use_tioctl</B> may be  updated  before  creating  each
       <I>screen</I>  rather  than  once  only  (<B><A HREF="curs_sp_funcs.3X.html">curs_sp_funcs(3X)</A></B>).  This feature of
       <B>use_env</B> is not provided by other implementation of curses.


</PRE><H2><a name="h2-SEE-ALSO">SEE ALSO</a></H2><PRE>
       <B><A HREF="curses.3X.html">curses(3X)</A></B>,   <B><A HREF="curs_initscr.3X.html">curs_initscr(3X)</A></B>,    <B><A HREF="curs_inopts.3X.html">curs_inopts(3X)</A></B>,    <B><A HREF="curs_kernel.3X.html">curs_kernel(3X)</A></B>,
       <B><A HREF="curs_scr_dump.3X.html">curs_scr_dump(3X)</A></B>,  <B><A HREF="curs_sp_funcs.3X.html">curs_sp_funcs(3X)</A></B>,  <B><A HREF="curs_variables.3X.html">curs_variables(3X)</A></B>, <B>legacy_cod-</B>
       <B><A HREF="legacy_coding.3X.html">ing(3X)</A></B>.



                                                                 <B><A HREF="curs_util.3X.html">curs_util(3X)</A></B>
</PRE>
<div class="nav">
<ul>
<li><a href="#h2-NAME">NAME</a></li>
<li><a href="#h2-SYNOPSIS">SYNOPSIS</a></li>
<li><a href="#h2-DESCRIPTION">DESCRIPTION</a>
<ul>
<li><a href="#h3-unctrl">unctrl</a></li>
<li><a href="#h3-keyname_key_name">keyname/key_name</a></li>
<li><a href="#h3-filter_nofilter">filter/nofilter</a></li>
<li><a href="#h3-use_env">use_env</a></li>
<li><a href="#h3-use_tioctl">use_tioctl</a></li>
<li><a href="#h3-putwin_getwin">putwin/getwin</a></li>
<li><a href="#h3-delay_output">delay_output</a></li>
<li><a href="#h3-flushinp">flushinp</a></li>
</ul>
</li>
<li><a href="#h2-RETURN-VALUE">RETURN VALUE</a></li>
<li><a href="#h2-PORTABILITY">PORTABILITY</a>
<ul>
<li><a href="#h3-filter">filter</a></li>
<li><a href="#h3-keyname">keyname</a></li>
<li><a href="#h3-nofilter_use_tioctl">nofilter/use_tioctl</a></li>
<li><a href="#h3-putwin_getwin">putwin/getwin</a></li>
<li><a href="#h3-unctrl_wunctrl">unctrl/wunctrl</a></li>
<li><a href="#h3-use_env_use_tioctl">use_env/use_tioctl</a></li>
</ul>
</li>
<li><a href="#h2-SEE-ALSO">SEE ALSO</a></li>
</ul>
</div>
</BODY>
</HTML>
